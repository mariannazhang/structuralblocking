---
title: Reanalysis of Muradoglu et al (2019, SRCD)
author: "Marianna Zhang (marianna.zhang@stanford.edu)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: no
  pdf_document:
    toc: yes
    toc_depth: '3'
---


## Introduction

Muradoglu et al 2019, Experiment 2 (social domain) found that a formal explanation boosts essentialism of gender compared to a control explanation, using a battery of essentialism measures. 

This reanalysis examines if the effect holds with just one dependent measure of essentialism - mutability/innateness - to inform the study design of Marianna's FYP. 


## Data Formatting

```{r "knitr config", cache = FALSE}
require("knitr")
```

```{r}
### Data Preparation

#### Load Relevant Libraries and Functions
library(tidyverse)

#### Import data for analysis
data <- read_csv("MuradogluEtAl_2019_social_data.csv")

#### Initial data formatting
##### Rename questions
data <- data %>% 
  rename(condition = formex) %>% 
  mutate(question = recode(question, 
         "1" = "stability_past",
         "2" = "stability_future",
         "3" = "innateness_switch",
         "4" = "innateness_stop",
         "5" = "inductivePotential"),
         condition = recode(condition,
          "0" = "control",
          "1" = "formal explanation"))


```



## Reproducing original results

```{r}
# Summary: essentialism by condition
data_summary <- data %>% 
  group_by(condition) %>% 
  summarize(avg=mean(response, na.rm=TRUE), sd=sd(response, na.rm=TRUE), n())
data_summary



# Essentialism per subject
data_subject <- data %>% 
  group_by(subj, age, condition) %>% 
  summarize(essentialism=mean(response, na.rm=TRUE), sd=sd(response, na.rm=TRUE))

# Plot of age vs essentialism by condition
ggplot(data_subject, aes(x = age, y = essentialism, color = condition)) + 
  geom_point() + 
  labs(x="Age (years)", 
       y="Essentialism (all measures)") +
  geom_smooth(method = "lm") +
  # Essentialism compound measure is 0 to 1 scale
  scale_y_continuous(limits=c(0,1)) +
  ggtitle("Age vs essentialism (all measures) by condition")

# ANOVA on essentialism between conditions with age as interaction
model = aov(essentialism ~ condition * age, data_subject)
summary(model)
```

As in the original analysis, the main effect of condition was not significant, p = .11. 

The following original results were reproduced with a slightly larger p-values, which do not change their statistical significance. In the original analysis, the condition by age interaction was significant, p = .044. In this analysis, the condition by age interaction was significant, p = .045. In the original analysis, children gave more essentialist responses with age, p= .003. In this analysis, children gave more essentialist responses with age, p= .015. 


```{r}
# Exploratory analysis by age
# essentialism between conditions, 6yo
data_subject_6yo <- data_subject %>% 
  filter(age >= 6 & age < 7)
model_6yo = aov(essentialism ~ condition, data_subject_6yo)
summary(model_6yo)

# essentialism between conditions, 5yo
data_subject_5yo <- data_subject %>% 
  filter(age < 6 & age >= 5)
model_5yo = aov(essentialism ~ condition, data_subject_5yo)
summary(model_5yo)
```


The following original results were reproduced with a slightly different p-values, which do not change their statistical significance. In the original analysis, six-year-olds, but not 5-year olds, showed higher essentialism for properties introduced via formal explanations (ps = .011 and .999). In this analysis, six-year-olds, but not 5-year olds, showed higher essentialism for properties introduced via formal explanations (ps = .019 and .953). 




## Reanalyzing with just innateness switch item

```{r}
# Filtering to innateness switch
data_innateness_switch <- data %>% 
  filter(question == "innateness_switch")

# Summary: essentialism (innateness switch only) by condition
data_innateness_switch_summary <- data_innateness_switch %>% 
  group_by(condition) %>% 
  summarize(avg=mean(response, na.rm=TRUE), sd=sd(response, na.rm=TRUE), n())
data_innateness_switch_summary



# Essentialism (innateness switch only) per subject
data_innateness_switch_subject <- data_innateness_switch %>% 
  group_by(subj, age, condition) %>% 
  summarize(essentialism=mean(response, na.rm=TRUE), sd=sd(response, na.rm=TRUE))

# Plot of age vs essentialism by condition
ggplot(data_innateness_switch_subject, aes(x = age, y = essentialism, color = condition)) + 
  geom_point() + 
  labs(x="Age (years)", 
       y="Essentialism (innateness switch only)") +
  geom_smooth(method = "lm") +
  # Essentialism compound measure is 0 to 1 scale
  scale_y_continuous(limits=c(0,1)) +
  ggtitle("Age vs essentialism (innateness switch only) by condition")

# ANOVA on essentialism between conditions with age as interaction
model_innateness_switch = aov(essentialism ~ condition * age, data_innateness_switch_subject)
summary(model_innateness_switch)
```

The main effect of condition is not significant, p = .63. 

The condition by age interaction is no longer significant, p = .41. The main effect of age is also no longer significant, p= .19.

```{r}
# Analysis by age
# essentialism between conditions, 6yo
data_innateness_switch_subject_6yo <- data_innateness_switch_subject %>% 
  filter(age >= 6 & age < 7)
model_innateness_switch_6yo = aov(essentialism ~ condition, data_innateness_switch_subject_6yo)
summary(model_innateness_switch_6yo)

# essentialism between conditions, 5yo
data_innateness_switch_subject_5yo <- data_innateness_switch_subject %>% 
  filter(age < 6 & age >= 5)
model_innateness_switch_5yo = aov(essentialism ~ condition, data_innateness_switch_subject_5yo)
summary(model_innateness_switch_5yo)
```

Neither 6-year-olds nor 5-year-olds showed higher essentialism ratings on the innateness switch task in the formal explanation condition compared to the control condition (ps = .61 and .83).
